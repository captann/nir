<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Анализатор кода</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
        }
        h1, h2 {
            color: #333;
        }
        .item {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            background-color: #fff;
        }
        .item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .tag {
            display: inline-block;
            background-color: #e9ecef;
            padding: 2px 8px;
            border-radius: 12px;
            margin: 2px;
            font-size: 0.9em;
        }
        .warning {
            color: #dc3545;
        }
        .deprecated {
            background-color: #ffecec;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Анализатор кода</h1>
        
        <div class="section" id="functions">
            <h2>Функции</h2>
            <div id="functions-list"></div>
        </div>

        <div class="section" id="constants">
            <h2>Константы</h2>
            <div id="constants-list"></div>
        </div>

        <div class="section" id="variables">
            <h2>Переменные</h2>
            <div id="variables-list"></div>
        </div>

        <div class="section" id="structures">
            <h2>Структуры</h2>
            <div id="structures-list"></div>
        </div>
    </div>

    <script>
        async function loadData() {
            try {
                const response = await fetch('code_data.json');
                const data = await response.json();
                
                displayFunctions(data.functions);
                displayConstants(data.constants);
                displayVariables(data.variables);
                displayStructures(data.structures);
            } catch (error) {
                console.error('Ошибка загрузки данных:', error);
            }
        }

        function createTags(tags) {
            return tags.map(tag => `<span class="tag">${tag}</span>`).join(' ');
        }

        function displayFunctions(functions) {
            const container = document.getElementById('functions-list');
            functions.forEach(func => {
                const element = document.createElement('div');
                element.className = `item ${func.deprecated ? 'deprecated' : ''}`;
                element.innerHTML = `
                    <h3>${func.name}</h3>
                    <p>${func.description || 'Описание отсутствует'}</p>
                    <p><strong>Файл:</strong> ${func.file_path}</p>
                    <p><strong>Параметры:</strong> ${func.input_params.map(p => `${p.type} ${p.name}`).join(', ') || 'нет'}</p>
                    ${func.warnings ? `<p class="warning"><strong>Предупреждения:</strong> ${func.warnings}</p>` : ''}
                    <div>${createTags(func.tags)}</div>
                `;
                container.appendChild(element);
            });
        }

        function displayConstants(constants) {
            const container = document.getElementById('constants-list');
            constants.forEach(constant => {
                const element = document.createElement('div');
                element.className = `item ${constant.deprecated ? 'deprecated' : ''}`;
                element.innerHTML = `
                    <h3>${constant.name}</h3>
                    <p>${constant.description || 'Описание отсутствует'}</p>
                    <p><strong>Значение:</strong> ${constant.value}</p>
                    <p><strong>Тип:</strong> ${constant.type}</p>
                    ${constant.warnings ? `<p class="warning"><strong>Предупреждения:</strong> ${constant.warnings}</p>` : ''}
                    <div>${createTags(constant.tags)}</div>
                `;
                container.appendChild(element);
            });
        }

        function displayVariables(variables) {
            const container = document.getElementById('variables-list');
            variables.forEach(variable => {
                const element = document.createElement('div');
                element.className = `item ${variable.deprecated ? 'deprecated' : ''}`;
                element.innerHTML = `
                    <h3>${variable.name}</h3>
                    <p>${variable.description || 'Описание отсутствует'}</p>
                    <p><strong>Тип:</strong> ${variable.type}</p>
                    <p><strong>Область видимости:</strong> ${variable.scope}</p>
                    ${variable.warnings ? `<p class="warning"><strong>Предупреждения:</strong> ${variable.warnings}</p>` : ''}
                    <div>${createTags(variable.tags)}</div>
                `;
                container.appendChild(element);
            });
        }

        function displayStructures(structures) {
            const container = document.getElementById('structures-list');
            structures.forEach(structure => {
                const element = document.createElement('div');
                element.className = `item ${structure.deprecated ? 'deprecated' : ''}`;
                element.innerHTML = `
                    <h3>${structure.name}</h3>
                    <p>${structure.description || 'Описание отсутствует'}</p>
                    <p><strong>Размер:</strong> ${structure.size} байт</p>
                    <p><strong>Выравнивание:</strong> ${structure.alignment} байт</p>
                    ${structure.warnings ? `<p class="warning"><strong>Предупреждения:</strong> ${structure.warnings}</p>` : ''}
                    <div>${createTags(structure.tags)}</div>
                `;
                container.appendChild(element);
            });
        }

        window.addEventListener('load', loadData);
    </script>
</body>
</html>
